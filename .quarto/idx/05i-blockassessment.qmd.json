{"title":"Assessing the Modeling Conditions in Repeated Measures ANOVA","markdown":{"headingText":"Assessing the Modeling Conditions in Repeated Measures ANOVA","headingAttr":{"id":"sec-blockassessment","classes":[],"keyvalue":[]},"containsRefs":false,"markdown":"\n{{< include _setupcode.qmd >}}\n\nIn this unit we have discussed a model relating a quantitative response to a categorical predictor in the presence of blocks which induce correlation among the responses.  For the Frozen Yogurt Case Study, our model had the form\n\n$$\n\\begin{aligned}\n  (\\text{Taste Rating})_i &= \\mu_1 (\\text{East Side})_i + \\mu_2 (\\text{Name Brand})_i + \\mu_3 (\\text{South Side})_i \\\\\n    &\\qquad + \\beta_2 (\\text{Participant 2})_i + \\beta_3 (\\text{Participant 3})_i + \\beta_4 (\\text{Participant 4})_i \\\\\n    &\\qquad + \\beta_5 (\\text{Participant 5})_i + \\beta_6 (\\text{Participant 6})_i + \\beta_7 (\\text{Participant 7})_i \\\\\n    &\\qquad + \\beta_8 (\\text{Participant 8})_i + \\beta_9 (\\text{Participant 9})_i + \\varepsilon_i\n\\end{aligned}\n$$\n\nwhere we use the same indicator variables defined in @sec-blockmodel.  Further, we considered several conditions on the distribution of the error term and the distribution of the block effects:\n\n  1. The error in the taste ratings within one individual is independent of the error in the taste ratings within any other individual.\n  2. The variability in the error in the taste ratings is the same for all vendor and participant combinations.\n  3. The error in the taste ratings follows a Normal distribution.\n  4. The deterministic portion of the model is correctly specified; that is, any differences in the ratings across vendors is the same for all participants.\n  5. One participant's preferences relative to the population is independent of any other participant's preferences; that is, the block effects are independent of one another.\n  6. Each participant's preferences relative to the population is independent of of the error in the taste ratings of all individuals; that is, the block effects are independent of the error terms.\n  7. Participants' preferences follow a Normal distribution; that is, the block effects follow a Normal distribution.\n  \nWhile we imposed each of these conditions in @sec-blockteststat, we could have developed an empirical model for the null distribution of the standardized statistic imposing only a subset of these conditions.  Unfortunately, we cannot simply state conditions and then proceed blindly.  In order to rely on the p-values and confidence intervals produced from any modeling procedure, the data must be consistent with the conditions imposed.\n\nIn this section, we discuss how we assess these conditions qualitatively.  We note that the last three conditions on the block effects are not easily assessed.  These are generally stated and assumed.  \n\n:::{.callout-warning}\nThe conditions on the block effects in a repeated measures ANOVA model are not easily assessed and tend to be stated and assumed in practice.\n:::\n\nJust as we saw in @sec-regassessment and @sec-anovaassessment, however, the first four conditions placed on the error distribution can be assessed using __residuals__.\n\n:::{.theorem.definition}\n```{r}\n#| label: blockassessment-get-def-residual\n#| output: asis\n\nread_lines('03i-regassessment.qmd') |>\n  repeat_block(pattern = ':::\\\\{#def-residual') |>\n  get_terms(term = 'fullblock') |>\n  cat()\n```\n:::\n  \nFor the repeated measures ANOVA model, the predicted mean response is determined by using the least squares estimates from the model:\n\n$$(\\text{Predicted Mean Response})_i = \\sum_{j=1}^{k} \\widehat{\\mu}_j (\\text{Group } j)_i + \\sum_{m=2}^{b} \\widehat{\\beta}_m (\\text{Block } m)_i.$$\n\n:::{.callout-tip}\n## Big Idea\nThe conditions are placed on the error term, but they are assessed with residuals.\n:::\n\n```{r}\n#| label: blockassessment-augmented\n\nfit.yogurt <- lm(Taste ~ Type + `Participant ID` - 1, data = yogurt.df)\n\nyogurt.augmented <- augment(fit.yogurt)\n```\n\n\n## Assessing the Independence Condition\n  > The error in the taste ratings within one individual is independent of the error in the taste ratings within any other individual.\n  \nGenerally, independence is assessed by considering the method in which the data was collected and considering the context with a discipline expert.  By carefully considering the manner in which the data was collected, we can typically determine whether it is reasonable that the errors in the response are independent of one another.  When a study design incorporates blocking, it was because researchers had identified a source of correlation prior to conducting the study.  Further, the researchers are generally willing to assume that observations within the block are independent of one another and the units in different blocks are independent of one another.  That is, the study design considered the possible sources of correlation and accounted for them.  \n\nWhile the incorporation of the blocks into the model for the data generating process should eliminate any correlation in the errors due to observations being from the same block, it is possible that other forms of correlation exist.  For example, if the data is collected over time, it is possible that observations collected in proximity to one another exhibit a relationship; and, such a relationship would not be captured by the block terms.  When we know the order in which the data was collected, we can assess whether the data tends to deviate from the condition of independence over time.  This is done graphically through a __time-series plot__ of the _residuals_.  If two errors were unrelated, then the value of one residual should tell us nothing about the value of the next residual.  Therefore, a plot of the residuals over time should look like noise (since residuals are supposed to mimic the noise in the model).  If there are any trends, then it suggests the data is not consistent with independence.\n\n:::{.theorem.definition}\n```{r}\n#| label: blockassessment-get-def-time-series-plot\n#| output: asis\n\nread_lines('03i-regassessment.qmd') |>\n  repeat_block(pattern = ':::\\\\{#def-time-series-plot') |>\n  get_terms(term = 'fullblock') |>\n  cat()\n```\n:::\n\n:::{.callout-note}\n## Graphically Assessing the Independence Condition\nIf the data is consistent with the independence condition, we would not expect to see a trend in the _location_ or _spread_ in a time-series plot of the residuals.  Note that this graphic can only be used if the order in which the data was collected is known, and the order indicates some natural timing.  Otherwise, we generally assume the inclusion of the block terms captured the primary source of correlation among responses.\n:::\n\nFor the Frozen Yogurt Case Study, participants were assessed simultaneously within the class.  Therefore, there is no ordering in time to be concerned about.  As such, a time-series plot of the residuals would not be useful here.  Considering the context, the students were the ones who had designed the study (it was carried out by their instructor); therefore, they were concerned about the quality of the data collection.  The students did their best to not influence the ratings of any other participant.  It is reasonable to assume the data is consistent with the independence condition once the repeated measures have been accounted for by the inclusion of the block terms in the model.\n\n\n## Assessing Homoskedasticity\n  > The variability in the error in the taste ratings is the same for all vendor and participant combinations.\n  \nWe want the variability of the errors to be the same across all values of the predictors --- that is what is being captured with the phrase \"all vendor and participant combinations.\"  As a result, unlike @sec-anovaassessment, we cannot simply make a boxplot of the residuals across the three vendors.  Once there is more than one variable in the deterministic portion of the model for the data generating process, we must resort back to the strategy discussed in @sec-regassessment.  That is, we construct a plot of the residuals against the predicted values.  \n\n:::{.callout-warning}\nEven though our goal is to compare the mean response across groups as in ANOVA, since a repeated measures ANOVA model contains multiple variables in the deterministic portion of the model for the data generating process, we cannot assess the constant variance condition in the same way.\n:::\n\n:::{.callout-note}\n## Graphically Assessing the Constant Variance Condition\nIf the data is consistent with the constant variance condition, there should be no trends in the _spread_ of the residuals when plotted against the predicted mean response (the fitted values).\n:::\n\n@fig-blockassessment-variance-yogurt shows the residuals for each individual across the predicted taste rating for that individual observation.  Notice that as the predicted taste ratings increase, the variability in the residuals tends to decrease.  This is inconsistent with what we would expect if the variability in the errors was constant.  That is, if the variability of the errors was constant, we would not expect the spread of the residuals to exhibit this \"fan\" shape.  Therefore, we do not feel it is reasonable to impose the constant variance condition.\n\n```{r}\n#| label: fig-blockassessment-variance-yogurt\n#| fig-cap: Plot of the residuals against the predicted values from a model comparing the taste ratings across yogurt vendors accounting for subject-variability.\n#| fig-alt: Scatter plot of residuals against predicted values revealing a trend in the spread of the residuals.\n\nggplot(data = yogurt.augmented,\n       mapping = aes(y = .resid,\n                     x = .fitted)) +\n  geom_point() +\n  labs(y = \"Residuals\",\n       x = \"Predicted Taste Ratings\")\n```\n\n## Assessing Normality\n  > The error in the taste ratings follows a Normal distribution.\n  \nIf the errors follow a Normal distribution, then we would expect the residuals to mimic a sample taken from a Normal distribution.  As introduced in @sec-regassessment, we emphasize the Normal __probability plot__ for assessing the Normality condition.\n\n:::{.theorem.definition}\n```{r}\n#| label: blockassessment-get-def-probability-plot\n#| output: asis\n\nread_lines('03i-regassessment.qmd') |>\n  repeat_block(pattern = ':::\\\\{#def-probability-plot') |>\n  get_terms(term = 'fullblock') |>\n  cat()\n```\n:::\n\n:::{.callout-note}\n## Graphically Assessing the Normality Condition\nIf the data is consistent with the normality condition, the Normal probability plot of the residuals should exhibit a straight line with any deviations appearing to be random.  Systemic deviations from a straight line indicate the observed distribution does not align with the proposed model.\n:::\n\n@fig-blockassessment-normal-yogurt shows the probability plot for the residuals from the Frozen Yogurt Case Study.\n\n```{r}\n#| label: fig-blockassessment-normal-yogurt\n#| fig-cap: Probability plot of the residuals for the Frozen Yogurt Case Study.  If the errors follow a Normal distribution, we would expect the residuals to fall along a straight line.\n#| fig-alt: Plot of the sample quantiles against the theoretical quantiles exhibiting a straight line.\nggplot(data = yogurt.augmented,\n       mapping = aes(sample = .resid)) +\n  geom_qq() +\n  labs(x = \"Theoretical Quantiles\", y = \"Sample Quantiles\") \n```\n\nOverall, the points do tend to follow a straight line.  It seems reasonable the data is consistent with the errors following a Normal distribution.\n  \n## Assessing Whether the Model is Correctly Specified\n  > The deterministic portion of the model is correctly specified; that is, any differences in the ratings across vendors is the same for all participants.\n\nRecall that the _structure_ of our repeated measures ANOVA model suggests that any differences between groups are the same across all blocks.  This is analogous to assuming a specific functional form for the relationship between two predictors (for example, linear or sinusoidal).  Because we are discussing the structure of the deterministic portion of the model for the data generating process, occasionally, we can assess this condition from the context of the problem with the help of a discipline expert.  For example, do we believe it is reasonable to believe that every individual will have the same vendor preference for frozen yogurt?  Our personal experience alone tells us one person's favorite restaurant is not necessarily everyone's favorite restaurant; so, there is some reason already to doubt this condition is reasonable for the Frozen Yogurt Case Study.\n\nWhen we (or the discipline experts) do not have enough knowledge to confidently assess this condition, we can examine a graphic of the residuals and predicted values.  Recall that in @sec-regconditions and @sec-regassessment, we argued that the deterministic portion of the model being correctly specified was the result of the errors having a value of 0, on average.  That is, the mean-0 condition is synonymous with requiring the deterministic portion of the model for the data generating process to have the correctly specified structure.\n\nIf the errors have a mean of 0 for all combination of variables in the deterministic portion of the model, then we would expect the residuals to have a mean of 0 for all predicted values.  That is, if the data is consistent with the mean-0 condition, then as we move left to right across a plot of the residuals and predicted values, the residuals should tend to balance out at 0 everywhere along the x-axis.  Any trends in the _location_ of this graphic would indicate the data is _not_ consistent with the mean-0 condition.  \n\n:::{.callout-note}\n## Graphically Assessing the Mean-0 Condition\nIf the data is consistent with the mean-0 condition, there should be no trends in the _location_ of the plot of the residuals against the predicted values.\n:::\n\nAs we examine @fig-blockassessment-variance-yogurt, the residuals do tend to balance out at 0 everywhere along the x-axis.  That is, we do not see a trend in the location of the residuals as the predicted values increase.  Therefore, it is reasonable to say the sample is consistent with the mean-0 condition.  \n\nThe sample seems to be at odds with our personal experience.  Remember, we cannot use the graphic to confirm the condition is met; we can only say the data is _consistent_ with the behavior we would expect of the residuals if the the condition were true.  It is probably the case that any differences in vendor preferences across individuals is so slight that the structure we have imposed is reasonable in this sample.\n\n\n## General Tips for Assessing Assumptions\nFirst discussed in @sec-regassessment, we want to remember four things that should be kept in mind when assessing conditions:\n\n  1. We should not spend an extraordinary amount of time examining any one residual plot; we might convince ourselves of patterns that do not exist.  We are looking for major deviations from our expectations.\n  2. We can never prove a condition is satisfied; we can only determine whether the data is consistent with a condition or whether it is not consistent with a condition.\n  3. Any condition required for a particular analysis should be assessed.\n  4. Transparency is crucial.\n  \nIn this chapter, we add to these four tips that conditions placed on the block effects cannot be graphically assessed.  \n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"center","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["mystyles.css"],"output-file":"05i-blockassessment.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.353","bibliography":["refs223notes.bib","packages.bib"],"comments":{"hypothesis":false},"fig-cap-location":"bottom","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":true,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"center","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"05i-blockassessment.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"bibliography":["refs223notes.bib","packages.bib"],"comments":{"hypothesis":false},"fig-cap-location":"bottom","documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}